@model CompetitionsWebsite.ViewModels.ProfileViewModel

@{
    ViewData["Title"] = "الملف الشخصي - مسابقات تعليمية إسلامية";
    Layout = null;
}

<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"]</title>
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/profile.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    <style>
      
    </style>
</head>
<body>
    <header>
        <nav class="main-nav">
            <div class="logo">
                <h1>مسابقات تعليمية</h1>
            </div>
            <div class="nav-links">
                <a href="@Url.Action("Index", "Home")">الرئيسية</a>
                <a href="@Url.Action("Login", "Auth")">تسجيل الدخول</a>
                <a href="@Url.Action("Profile", "Profile")" class="active">الملف الشخصي</a>
            </div>
        </nav>
    </header>

    <main>
        <div class="profile-container">
            <!-- User Header Section -->
            <div class="user-header">
                <h1>@Model.UserName</h1>
                <p class="member-since">عضو منذ: @Model.JoinDate.ToString("MMMM yyyy")</p>

                <p class="welcome-message">مرحباً بك في رحلتك التعليمية الإسلامية!</p>
            </div>

            <!-- Statistics Dashboard -->
            <div class="stats-dashboard">
                <div class="stat-card completed">
                    <i class="fas fa-check-circle"></i>
                    <div class="stat-number">@Model.TotalAttempts</div>
                    <div class="stat-label">المسابقات المكتملة</div>
                </div>

                <div class="stat-card average">
                    <i class="fas fa-chart-line"></i>
                    <div class="stat-number">@Model.AverageScore%</div>
                    <div class="stat-label">المتوسط العام</div>
                </div>
                <div class="stat-card best">
                    <i class="fas fa-star"></i>
                    <div class="stat-number">@Model.BestScore%</div>
                    <div class="stat-label">أفضل نتيجة</div>
                </div>

            </div>

            <!-- Quiz History Section -->
            <div class="quiz-history">
                <h2><i class="fas fa-history"></i> سجل المسابقات</h2>
                
                @foreach (var attempt in Model.Attempts)
                {
                    <div class="quiz-item">
                        <div class="quiz-item-header">
                            <div class="quiz-name">
                                @attempt.CategoryName
                                <span class="difficulty-indicator">@attempt.Level</span>
                            </div>
                            <div class="quiz-date">@attempt.AttemptDate.ToString("dd/MM/yyyy")</div>
                        </div>

                        <div class="quiz-item-body">
                            <div class="quiz-metric">
                                <div class="quiz-metric-value">@attempt.Score</div>
                                <div class="quiz-metric-label">النتيجة</div>
                            </div>
                        </div>

                        <div class="quiz-actions">
                            <a href="javascript:void(0);" onclick="toggleDetails(@attempt.AttemptId)" class="btn-small btn-details">
                                <i class="fas fa-eye"></i> عرض التفاصيل
                            </a>
                        </div>

                        <div class="quiz-details" id="details-@attempt.AttemptId" style="display:none;">
                            <ul>
                                @foreach (var answer in attempt.Answers)
                                {
                                    <li>
                                        <strong>@answer.QuestionText</strong><br />
                                        إجابتك: @answer.UserResponse<br />
                                        الإجابة الصحيحة: @answer.CorrectAnswer<br />
                                        <span style="color:@(answer.IsCorrect ? "green" : "red")">
                                            @(answer.IsCorrect ? "صحيحة ✅" : "خاطئة ❌")
                                        </span>
                                    </li>
                                }
                            </ul>
                        </div>
                    </div>
                }

            </div>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <h2><i class="fas fa-bolt"></i> الإجراءات السريعة</h2>
                <div class="action-buttons">
                    <a href="@Url.Action("Index", "Quiz")" class="btn-action">
                        <i class="fas fa-play"></i>
                        ابدأ مسابقة جديدة
                    </a>
                    <a href="@Url.Action("Browse", "Quiz")" class="btn-action">
                        <i class="fas fa-search"></i>
                        تصفح المسابقات
                    </a>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <p>جميع الحقوق محفوظة © 2024</p>
    </footer>

    <script>
        // Add some interactive effects
        document.addEventListener('DOMContentLoaded', function() {
            // Animate stat cards on scroll
            const statCards = document.querySelectorAll('.stat-card');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.animation = 'fadeInUp 0.6s ease forwards';
                    }
                });
            });

            statCards.forEach(card => {
                observer.observe(card);
            });

            // Add hover effects to quiz items
            const quizItems = document.querySelectorAll('.quiz-item');
            quizItems.forEach(item => {
                item.addEventListener('mouseenter', function() {
                    this.style.borderColor = 'var(--primary-color)';
                });
                item.addEventListener('mouseleave', function() {
                    this.style.borderColor = 'var(--border-color)';
                });
            });
        });

        // CSS animations
        const style = document.createElement('style');
        style.textContent = `
            @@keyframes fadeInUp {
                from {
                    opacity: 0;
                    transform: translateY(20px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
        `;
        document.head.appendChild(style);

            function toggleDetails(id) {
                const el = document.getElementById(`details-${id}`);
            el.style.display = el.style.display === "none" ? "block" : "none";
            }
 

    </script>
</body>
</html>